@using GiftOfGivers.Client.Helpers

<button class="@GetSwitchClasses()" 
        @onclick="Toggle" 
        role="switch" 
        aria-checked="@Checked"
        @attributes="AdditionalAttributes">
    <div class="@GetThumbClasses()"></div>
</button>

@code {
    [Parameter] public bool Checked { get; set; }
    [Parameter] public EventCallback<bool> OnCheckedChange { get; set; }
    [Parameter] public string? Class { get; set; }
    [Parameter(CaptureUnmatchedValues = true)] public Dictionary<string, object>? AdditionalAttributes { get; set; }

    private string GetSwitchClasses()
    {
        var baseClasses = "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50";
        var stateClasses = Checked ? "bg-primary" : "bg-input";
        return Utils.Cn(baseClasses, stateClasses, Class);
    }

    private string GetThumbClasses()
    {
        var baseClasses = "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform";
        var positionClasses = Checked ? "translate-x-5" : "translate-x-0";
        return Utils.Cn(baseClasses, positionClasses);
    }

    private async Task Toggle()
    {
        Checked = !Checked;
        await OnCheckedChange.InvokeAsync(Checked);
    }
}